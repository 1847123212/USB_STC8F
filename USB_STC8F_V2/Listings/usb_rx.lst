A51 MACRO ASSEMBLER  USB_RX                                                               08/14/2019 09:51:37 PAGE     1


MACRO ASSEMBLER A51 V8.2.7.0
OBJECT MODULE PLACED IN .\Objects\usb_rx.obj
ASSEMBLER INVOKED BY: C:\Program Files\Keil C\C51\C51\BIN\A51.EXE USB\Src\usb_rx.asm SET(SMALL) DEBUG PRINT(.\Listings\u
                      sb_rx.lst) OBJECT(.\Objects\usb_rx.obj) EP

LOC  OBJ            LINE     SOURCE

                       1     
                       2     
                       3     
                       4     
                       5     
                       6     
                       7     
                       8     
                       9     
                      10     NAME    USB_RX
                      11             
                      12     ?PR?usb_rx?USB_RX SEGMENT CODE
                      13             EXTRN   DATA (usb_rx_buffer, usb_rx_count, UEPF, UDRF)
                      14             EXTRN   CODE (usb_received)
                      15             EXTRN   CODE (USB_Process)
                      16             PUBLIC usb_rx
----                  17             RSEG  ?PR?usb_rx?USB_RX
0000                  18     usb_rx:
0000 7409             19             MOV A, #9
0002                  20     delay:
0002 00               21             NOP
0003 00               22             NOP
0004 00               23             NOP
0005 00               24             NOP
0006 00               25             NOP
0007 00               26             NOP
0008 14               27             DEC A
0009 70F7             28             JNZ delay
                      29             
000B 00               30             NOP
000C 00               31             NOP
000D 00               32             NOP
000E 00               33             NOP
000F 00               34             NOP
0010 00               35             NOP
                      36             
0011 00               37             NOP
                      38             
0012 7B06             39             MOV R3, #0x06
0014 7A01             40             MOV R2, #0x01
0016 7900     F       41             MOV R1, #usb_rx_buffer
0018 780C             42             MOV R0, #12
001A 7780             43             MOV @R1, #0x80
                      44             
001C 020000   F       45             LJMP bit0
                      46             
001F                  47     bit7:
001F E5B0             48             MOV A, 0xB0                           ; 1
0021 5403             49             ANL A, #0x03                          ; 1
0023 605F             50             JZ END1_RX                            ; 1/3
0025 6A               51             XRL A, R2                             ; 1
                      52     
0026 13               53             RRC A
0027 13               54             RRC A
0028 F7               55             MOV @R1, A
0029 33               56             RLC A
002A C2E1             57             CLR 0xE0.1
A51 MACRO ASSEMBLER  USB_RX                                                               08/14/2019 09:51:37 PAGE     2

002C FA               58             MOV R2, A                                                         ; 10
                      59             
002D 00               60             NOP
002E 500B             61             JNC next7
                      62             
0030 00               63             NOP
0031 00               64             NOP
0032 00               65             NOP
0033 DB0B             66             DJNZ R3, bit0                             ; 2/3
0035 120000   F       67             LCALL bit_idle                        ; 
0038 020000   F       68             LJMP bit0                             ; 3
003B                  69     next7:
003B 7B06             70             MOV R3, #0x06                                             ; 1
003D 020000   F       71             LJMP bit0
                      72             
0040                  73     bit0:
                      74     
                                     
                             
0040 00               77             NOP
                      78     
0041 E5B0             79             MOV A, 0xB0                           ; 1
0043 5403             80             ANL A, #0x03                          ; 1
0045 603D             81             JZ END1_RX                            ; 1/3
0047 6A               82             XRL A, R2                             ; 1
0048 C2E2             83             CLR 0xE0.2                            ; 1
004A 13               84             RRC A                                 ; 1
004B FA               85             MOV R2, A                             ; 1
004C 09               86             INC R1                                                            ; 1
                      87             
004D E8               88             MOV A, R0                                                         ; 1
004E 6034             89             JZ END1_RX                                                        ; 1/3
                      90             
0050 00               91             NOP
0051 500A             92             JNC next0
0053 00               93             NOP
0054 00               94             NOP                                                                       ; 15
0055 DB0A             95             DJNZ R3, bit1                         ; 2/3
0057 120000   F       96             LCALL bit_idle                        ; 
005A 020000   F       97             LJMP bit1                             ; 3
005D                  98     next0:
005D 7B06             99             MOV R3, #0x06                                             ; 1
005F 00              100             NOP
0060 00              101             NOP
0061                 102     bit1:
0061 E5B0            103             MOV A, 0xB0                           ; 1
0063 5403            104             ANL A, #0x03                          ; 1
0065 601D            105             JZ END1_RX                            ; 1/3
0067 6A              106             XRL A, R2                             ; 1
0068 C2E2            107             CLR 0xE0.2                            ; 1
006A 13              108             RRC A                                 ; 1
006B FA              109             MOV R2, A                             ; 1
006C 00              110             NOP                                                                       ; 1
                     111             
006D 00              112             NOP
006E 500D            113             JNC next1
0070 00              114             NOP
0071 00              115             NOP
0072 00              116             NOP
0073 00              117             NOP
0074 00              118             NOP
0075 DB32            119             DJNZ R3, bit2                         ; 2/3
0077 120000   F      120             LCALL bit_idle                        ; 
007A 020000   F      121             LJMP bit2                             ; 3
007D                 122     next1:
007D 7B06            123             MOV R3, #0x06                                             ; 1
A51 MACRO ASSEMBLER  USB_RX                                                               08/14/2019 09:51:37 PAGE     3

007F 00              124             NOP
0080 00              125             NOP
0081 020000   F      126             LJMP bit2
                     127             
0084                 128     END1_RX:
0084 740D            129             MOV A, #13
0086 98              130             SUBB A, R0
0087 F500     F      131             MOV usb_rx_count, A
0089 120000   F      132             LCALL usb_received
008C E500     F      133             MOV A, UDRF
008E 5500     F      134             ANL A, UEPF
0090 7001            135             JNZ goto_usb_process1
0092 22              136             RET
0093                 137     goto_usb_process1:
0093 C289            138             CLR 0x88.1
0095 D2AF            139             SETB 0xA8.7
0097 750000   F      140             MOV UEPF, #0
009A D0E0            141             POP ACC
009C D0E0            142             POP ACC
                     143             
009E 900000   F      144             MOV DPTR, #USB_Process
00A1 C082            145             PUSH DPL
00A3 C083            146             PUSH DPH
00A5 75D000          147             MOV PSW, #0
00A8 32              148             RETI
                     149             
00A9                 150     bit2:
00A9 E5B0            151             MOV A, 0xB0                           ; 1
00AB 5403            152             ANL A, #0x03                          ; 1
00AD 60D5            153             JZ END1_RX                            ; 1/3
00AF 6A              154             XRL A, R2                             ; 1
00B0 C2E2            155             CLR 0xE0.2                            ; 1
00B2 13              156             RRC A                                 ; 1
00B3 FA              157             MOV R2, A                             ; 1
00B4 00              158             NOP
                     159             
00B5 00              160             NOP
00B6 500D            161             JNC next2
00B8 00              162             NOP
00B9 00              163             NOP
00BA 00              164             NOP
00BB 00              165             NOP
00BC 00              166             NOP
00BD DB0D            167             DJNZ R3, bit3                         ; 2/3
00BF 120000   F      168             LCALL bit_idle                        ; 
00C2 020000   F      169             LJMP bit3                             ; 3
00C5                 170     next2:
00C5 7B06            171             MOV R3, #0x06                                             ; 1
00C7 00              172             NOP
00C8 00              173             NOP
00C9 00              174             NOP
00CA 00              175             NOP
00CB 00              176             NOP
00CC                 177     bit3:
00CC E5B0            178             MOV A, 0xB0                                                       ; 1
00CE 5403            179             ANL A, #0x03                                              ; 1
00D0 60B2            180             JZ END1_RX                                                        ; 1/3
00D2 6A              181             XRL A, R2                                                         ; 1
00D3 C2E2            182             CLR 0xE0.2                            ; 1
00D5 13              183             RRC A                                                             ; 1
00D6 FA              184             MOV R2, A                                                         ; 1
00D7 00              185             NOP
                     186             
00D8 00              187             NOP
00D9 500D            188             JNC next3
00DB 00              189             NOP
A51 MACRO ASSEMBLER  USB_RX                                                               08/14/2019 09:51:37 PAGE     4

00DC 00              190             NOP
00DD 00              191             NOP
00DE 00              192             NOP
00DF 00              193             NOP
00E0 DB0D            194             DJNZ R3, bit4                         ; 2/3
00E2 120000   F      195             LCALL bit_idle                        ; 
00E5 020000   F      196             LJMP bit4                             ; 3
00E8                 197     next3:
00E8 7B06            198             MOV R3, #0x06                                             ; 1
00EA 00              199             NOP
00EB 00              200             NOP
00EC 00              201             NOP
00ED 00              202             NOP
00EE 00              203             NOP
                     204             
00EF                 205     bit4:
00EF E5B0            206             MOV A, 0xB0                                                       ; 1
00F1 5403            207             ANL A, #0x03                                              ; 1
00F3 6040            208             JZ END2_RX                                                        ; 1/3
00F5 6A              209             XRL A, R2                                                         ; 1
00F6 C2E2            210             CLR 0xE0.2                            ; 1
00F8 13              211             RRC A                                                             ; 1
00F9 FA              212             MOV R2, A                                                         ; 1
00FA 00              213             NOP
                     214     
00FB 00              215             NOP
00FC 500D            216             JNC next4
00FE 00              217             NOP
00FF 00              218             NOP
0100 00              219             NOP
0101 00              220             NOP
0102 00              221             NOP
0103 DB0D            222             DJNZ R3, bit5                         ; 2/3
0105 120000   F      223             LCALL bit_idle                        ; 
0108 020000   F      224             LJMP bit5                             ; 3
010B                 225     next4:
010B 7B06            226             MOV R3, #0x06                                             ; 1
010D 00              227             NOP
010E 00              228             NOP
010F 00              229             NOP
0110 00              230             NOP
0111 00              231             NOP
0112                 232     bit5:
0112 E5B0            233             MOV A, 0xB0                                                       ; 1
0114 5403            234             ANL A, #0x03                                              ; 1
0116 601D            235             JZ END2_RX                            ; 1/3
0118 6A              236             XRL A, R2                             ; 1
0119 C2E2            237             CLR 0xE0.2                            ; 1
011B 13              238             RRC A                                 ; 1
011C FA              239             MOV R2, A                             ; 1
011D 00              240             NOP
                     241     
011E 00              242             NOP
011F 500D            243             JNC next5
0121 00              244             NOP
0122 00              245             NOP
0123 00              246             NOP
0124 00              247             NOP
0125 00              248             NOP
0126 DB32            249             DJNZ R3, bit6                         ; 2/3
0128 120000   F      250             LCALL bit_idle                        ; 
012B 020000   F      251             LJMP bit6                             ; 3
012E                 252     next5:
012E 7B06            253             MOV R3, #0x06                                             ; 1
0130 00              254             NOP
0131 00              255             NOP
A51 MACRO ASSEMBLER  USB_RX                                                               08/14/2019 09:51:37 PAGE     5

0132 020000   F      256             LJMP bit6
                     257             
0135                 258     END2_RX:
0135 740D            259             MOV A, #13
0137 98              260             SUBB A, R0
0138 F500     F      261             MOV usb_rx_count, A
013A 120000   F      262             LCALL usb_received
013D E500     F      263             MOV A, UDRF
013F 5500     F      264             ANL A, UEPF
0141 7001            265             JNZ goto_usb_process2
0143 22              266             RET
0144                 267     goto_usb_process2:
0144 C289            268             CLR 0x88.1
0146 D2AF            269             SETB 0xA8.7
0148 750000   F      270             MOV UEPF, #0
014B D0E0            271             POP ACC
014D D0E0            272             POP ACC
                     273             
014F 900000   F      274             MOV DPTR, #USB_Process
0152 C082            275             PUSH DPL
0154 C083            276             PUSH DPH
0156 75D000          277             MOV PSW, #0
0159 32              278             RETI
                     279             
015A                 280     bit6:
015A E5B0            281             MOV A, 0xB0                           ; 1
015C 5403            282             ANL A, #0x03                          ; 1
015E 60D5            283             JZ END2_RX                            ; 1/3
0160 6A              284             XRL A, R2                             ; 1
0161 C2E2            285             CLR 0xE0.2                            ; 1
0163 13              286             RRC A                                 ; 1
0164 FA              287             MOV R2, A                             ; 1
0165 18              288             DEC R0                                                            ; 1
                     289     
0166 00              290             NOP
0167 5010            291             JNC next6
0169 00              292             NOP
016A 00              293             NOP
016B DB09            294             DJNZ R3, goto_bit7                    ; 2/3
016D 00              295             NOP
016E 00              296             NOP
016F 00              297             NOP
0170 120000   F      298             LCALL bit_idle                        ; 
0173 020000   F      299             LJMP bit7                             ; 3
0176                 300     goto_bit7:
0176 020000   F      301             LJMP bit7
                     302     
0179                 303     next6:
0179 7B06            304             MOV R3, #0x06                                             ; 1
017B 00              305             NOP
017C 00              306             NOP
017D 020000   F      307             LJMP bit7
                     308             
0180                 309     bit_idle:
0180 7B06            310             MOV R3, #0x06
                     311     
                                     
                             
0182 00              314             NOP
                     315     
0183 EA              316             MOV A, R2
0184 B2E0            317             CPL 0xE0.0
0186 FA              318             MOV R2, A
0187 00              319             NOP
0188 00              320             NOP
0189 00              321             NOP
A51 MACRO ASSEMBLER  USB_RX                                                               08/14/2019 09:51:37 PAGE     6

018A 00              322             NOP
018B 00              323             NOP
                     324             ;NOP
                     325             ;NOP
018C 22              326             RET
                     327             
                     328             END
A51 MACRO ASSEMBLER  USB_RX                                                               08/14/2019 09:51:37 PAGE     7

SYMBOL TABLE LISTING
------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES

?PR?USB_RX?USB_RX.  C SEG    018DH       REL=UNIT
ACC. . . . . . . .  D ADDR   00E0H   A   
BIT0 . . . . . . .  C ADDR   0040H   R   SEG=?PR?USB_RX?USB_RX
BIT1 . . . . . . .  C ADDR   0061H   R   SEG=?PR?USB_RX?USB_RX
BIT2 . . . . . . .  C ADDR   00A9H   R   SEG=?PR?USB_RX?USB_RX
BIT3 . . . . . . .  C ADDR   00CCH   R   SEG=?PR?USB_RX?USB_RX
BIT4 . . . . . . .  C ADDR   00EFH   R   SEG=?PR?USB_RX?USB_RX
BIT5 . . . . . . .  C ADDR   0112H   R   SEG=?PR?USB_RX?USB_RX
BIT6 . . . . . . .  C ADDR   015AH   R   SEG=?PR?USB_RX?USB_RX
BIT7 . . . . . . .  C ADDR   001FH   R   SEG=?PR?USB_RX?USB_RX
BIT_IDLE . . . . .  C ADDR   0180H   R   SEG=?PR?USB_RX?USB_RX
DELAY. . . . . . .  C ADDR   0002H   R   SEG=?PR?USB_RX?USB_RX
DPH. . . . . . . .  D ADDR   0083H   A   
DPL. . . . . . . .  D ADDR   0082H   A   
END1_RX. . . . . .  C ADDR   0084H   R   SEG=?PR?USB_RX?USB_RX
END2_RX. . . . . .  C ADDR   0135H   R   SEG=?PR?USB_RX?USB_RX
GOTO_BIT7. . . . .  C ADDR   0176H   R   SEG=?PR?USB_RX?USB_RX
GOTO_USB_PROCESS1.  C ADDR   0093H   R   SEG=?PR?USB_RX?USB_RX
GOTO_USB_PROCESS2.  C ADDR   0144H   R   SEG=?PR?USB_RX?USB_RX
NEXT0. . . . . . .  C ADDR   005DH   R   SEG=?PR?USB_RX?USB_RX
NEXT1. . . . . . .  C ADDR   007DH   R   SEG=?PR?USB_RX?USB_RX
NEXT2. . . . . . .  C ADDR   00C5H   R   SEG=?PR?USB_RX?USB_RX
NEXT3. . . . . . .  C ADDR   00E8H   R   SEG=?PR?USB_RX?USB_RX
NEXT4. . . . . . .  C ADDR   010BH   R   SEG=?PR?USB_RX?USB_RX
NEXT5. . . . . . .  C ADDR   012EH   R   SEG=?PR?USB_RX?USB_RX
NEXT6. . . . . . .  C ADDR   0179H   R   SEG=?PR?USB_RX?USB_RX
NEXT7. . . . . . .  C ADDR   003BH   R   SEG=?PR?USB_RX?USB_RX
PSW. . . . . . . .  D ADDR   00D0H   A   
UDRF . . . . . . .  D ADDR   -----       EXT
UEPF . . . . . . .  D ADDR   -----       EXT
USB_PROCESS. . . .  C ADDR   -----       EXT
USB_RECEIVED . . .  C ADDR   -----       EXT
USB_RX . . . . . .  C ADDR   0000H   R   SEG=?PR?USB_RX?USB_RX
USB_RX_BUFFER. . .  D ADDR   -----       EXT
USB_RX_COUNT . . .  D ADDR   -----       EXT


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
